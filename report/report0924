关于非终结符实现多层，相比较于之前函数方法的实现（这也是吉老师给我留的接口），有一些工程上的问题需要另外和吉老师讨论#TODO
注：为什么要以非终结符实现，函数有什么问题？就像eusolver里需要识别出ite condition ......并把condition收集起来用于合一器的工作，全都以函数方式重写后失去了显式的ite condition 语句，虽然也可以通过修改eusolver的实现让他接受识别函数形式的分支语句，如果能直接以非终结符形式写出修改后的文法可能更符合大多数求解器的文法要求。【讨论后希望仍然使用函数形式的接口】

需要考虑的求解方法有？obe，eusolver，polygen，其他基于枚举的？
if condition S S 保留 测试！【eusolver测试时需要保留ite B S S不改动】
[检查函数形式的表现] 有问题需要修改函数形式与非终结符形式表现一致 等吉老师回应
[对于中间得到了去重后的结果，给定一种标准的输出格式用于中间储存] 免得每次都要重新跑去重 json？ 2
[任意层任意展开的工程实现][还差一个贝叶斯搜索的方法] 少数训练集 尝试展开一部分在训练集上观察效果 如果效果不好则回退（需要一个copy方法？） 1
[去重方法的优化 之前提过的树形优化] 3 记录
[编码测试集 参数个数和constraints][在吉老师benchmark上的修改 实验设定] 由于参数个数不同 需要跑一个参数个数多的文法 直接包含参数少的部分  3
重构代码（
（有什么提高performance的方法 benchmark偏好？结合律产生巨大差异 max sum15）

-------------------------------------------
【检查函数形式的表现】 
obe发现函数形式远远落后于非终结符形式 与原始相比 一个落后很多 一个有所提升 需要吉老师确认
eusolver发现函数形式跑得通但是效果同样非常差 函数：原始：非终结符=3786：66 :131(非终结符形式需要修改将常量提升非终结符 +的子项不能是终结符(熟悉的限制条件））
比较而言
1.函数形式都落后于非终结符形式 首先需要至少保证函数形式的文法读入之后效果和非终结符一致
2.其次 在obe中 不需要非终结符提升（允许 + x Start等），在eusolver中，必须要将子项提升为只产生单个终结符的非终结符 这一差别可能导致非终结符形式一个变好一个变差 （修改方案1：也许可以去掉eusolver的这个检查条件 修改方案2：读入时注意对于只产生单个终结符的非终结符的规模判定 应当被视作常量【重要：因为函数也有这个问题】）

【贝叶斯指导的任意层任意展开】
贝叶斯？？ 在某个固定的搜索空间中，如k维立方体，根据已有的采样点信息，指导下一个获取最大收益的采样点位置。利用了已知点信息的拟合模型作收益函数的评估
我们的单步问题：拿到一个文法，选择其中一个展开式展开一层去重，使得结果有改进或者不下降。收益函数可能可以直接写成去重条目的多少或者在小测试集上跑 遍历搜索加回溯？
这个空间虽然就是文法的展开空间，但是采样点和对应收益的刻画对后续没有帮助 【遍历搜索加回溯 需要一个copy方法 以小测试集的话需要先编码 参数和constraints等】
子问题：
1.给定一个文法，如何挑选下一步要展开的产生式。当前规模为length时，共有length种挑选可能，根据某种规则挑选展开式，先后顺序可能影响效率
    按顺序选择展开目标 优先长度短的（类似一种均匀展开）
2.给定文法，选中的要展开的产生式和展开规则，如何展开？
    如+ S S 还需要考虑展开哪一个S 或者应用一次全展开？ 否则就是选择第一个非终结符展开一次（展开k次等价于对展开一次的结果全都在1中选中再展开
3.为了最优化 判定是否需要应用本次展开？
    收集少量数据集 直接检查本次展开之后相比展开之前的效果 效果好或者在误差范围内可以接受
    设计估价函数 直接估计本次展开的收益大小 从而利用采样点快速回答前面的1和2 参考直接判断本次展开得到的等价式消减数量 （但是判断等价式的代价好像也不低）
    （贝叶斯搜索目标就是有这样的建模 问题在于每次空间不一样？扩展问题空间直接到多层以后？ 理论上空间确实是确定的 找到一种刻画方式即可）

[转换成贝叶斯问题] 采样点如何描述
如仅考虑对S的展开保留B不动（也保留ite B S S不动） 假定S共有k个展开式，其中包含非终结符的有3个 + S S| - S S| ite B S S， 可以展开的是前两个，因此第一维是[0,1]上取值，【如果每次展开都是将选中的产生式的第一个非终结符展开一次】，展开一次之后（如+ S S），第二次可选的包含非终结符的产生式有 1 + k - 1项，因此第二位是[0,k]上取值，如此类推。规定一个展开次数，我们可以确定一个搜索空间，如十次展开，这样的相邻的采样点具有一定的相似性，可以扔到贝叶斯模型里？
如果考虑全展开会怎么样？
每次不一定是增加k-1项，对只剩下一个非终结符的项展开时，增加的是3-1项 【贝叶斯需要确定的空间描述和点描述】
采样点受每次新增产生式的编号顺序影响 要确定编号顺序

   
